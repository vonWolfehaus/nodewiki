/* Riot v2.0.9, @license MIT, (c) 2015 Muut Inc. + contributors */
(function(){var e={version:"v2.0.9",settings:{}};"use strict";e.observable=function(e){e=e||{};var t={},n=0;e.on=function(r,i){if(typeof i=="function"){i._id=n++;r.replace(/\S+/g,function(e,n){(t[e]=t[e]||[]).push(i);i.typed=n>0})}return e};e.off=function(n,r){if(n=="*")t={};else if(r){var i=t[n];for(var o=0,u;u=i&&i[o];++o){if(u._id==r._id){i.splice(o,1);o--}}}else{n.replace(/\S+/g,function(e){t[e]=[]})}return e};e.one=function(t,n){if(n)n.one=1;return e.on(t,n)};e.trigger=function(n){var r=[].slice.call(arguments,1),i=t[n]||[];for(var o=0,u;u=i[o];++o){if(!u.busy){u.busy=1;u.apply(e,u.typed?[n].concat(r):r);if(u.one){i.splice(o,1);o--}else if(i[o]!==u){o--}u.busy=0}}return e};return e};(function(e,t){if(!this.top)return;var n=location,r=e.observable(),i=window,o;function u(){return n.hash.slice(1)}function a(e){return e.split("/")}function f(e){if(e.type)e=u();if(e!=o){r.trigger.apply(null,["H"].concat(a(e)));o=e}}var c=e.route=function(e){if(e[0]){n.hash=e;f(e)}else{r.on("H",e)}};c.exec=function(e){e.apply(null,a(u()))};c.parser=function(e){a=e};i.addEventListener?i.addEventListener(t,f,false):i.attachEvent("on"+t,f)})(e,"hashchange");var t=function(){var t={},n,r,i=/("|').+?[^\\]\1|\.\w*|\w*:|\b(?:(?:new|typeof|in|instanceof) |(?:this|true|false|null|undefined)\b|function *\()|([a-z_]\w*)/gi;return function(i,u){var a=e.settings.brackets||"{ }";if(a!=n){n=a.split(" ");r=f(/({[\s\S]*?})/)}return u?i&&(t[i]=t[i]||o(i))(u):r.test(i)};function o(e,t){t=(e||n.join("")).replace(f(/\\{/),"￰").replace(f(/\\}/),"￱").split(r);return new Function("d","return "+(!t[0]&&!t[2]&&!t[3]?u(t[1]):"["+t.map(function(e,t){return t%2?u(e,1):'"'+e.replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"'}).join(",")+'].join("")').replace(/\uFFF0/g,n[0]).replace(/\uFFF1/g,n[1]))}function u(e,t){e=e.replace(/\n/g," ").replace(f(/^[{ ]+|[ }]+$|\/\*.+?\*\//g),"");return/^\s*[\w- "']+ *:/.test(e)?"["+e.replace(/\W*([\w- ]+)\W*:([^,]+)/g,function(e,n,r){return r.replace(/\w[^,|& ]*/g,function(e){return a(e,t)})+'?"'+n.trim()+'":"",'})+'].join(" ")':a(e,t)}function a(e,t){return"(function(v){try{v="+(e.replace(i,function(e,t,n){return n?"(d."+n+"===undefined?window."+n+":d."+n+")":e})||"x")+"}finally{return "+(t?'!v&&v!==0?"":v':"v")+"}}).call(d)"}function f(e){return RegExp(e.source.split("{").join("\\"+n[0]).split("}").join("\\"+n[1]),e.global?"g":"")}}();function n(e){var t={val:e},n=e.split(/\s+in\s+/);if(n[1]){t.val=y+n[1];n=n[0].slice(y.length).trim().split(/,\s*/);t.key=n[0];t.pos=n[1]}return t}function r(e,t,n){var r={};r[e.key]=t;if(e.pos)r[e.pos]=n;return r}function i(e,i,o){p(e,"each");var u=e.outerHTML,f=e.previousSibling,c=e.parentNode,l=[],s=[],d;o=n(o);i.one("update",function(){c.removeChild(e)}).one("mount",function(){if(c.stub)c=i.root}).on("update",function(){var e=t(o.val,i);if(!e)return;if(!Array.isArray(e)){var n=JSON.stringify(e);if(n==d)return;d=n;s.map(function(e){e.unmount()});s=l=[];e=Object.keys(e).map(function(t){return r(o,t,e[t])})}g(l,e).map(function(e){var t=l.indexOf(e),n=s[t];if(n){n.unmount();l.splice(t,1);s.splice(t,1)}});var p=c.childNodes,m=[].indexOf.call(p,f);g(e,l).map(function(t,n){var f=e.indexOf(t);if(!d&&o.key)t=r(o,t,f);var l=new a({tmpl:u},{before:p[m+1+f],parent:i,root:c,loop:true,item:t});s.splice(f,0,l)});l=e.slice()})}function o(e,t,n){v(e,function(e){if(e.nodeType!=1)return;s(e.attributes,function(n){if(/^(name|id)$/.test(n.name))t[n.value]=e})})}function u(e,t,n){function r(e,t,r){if(t.indexOf(y)>=0){var i={dom:e,expr:t};n.push(d(i,r))}}v(e,function(e){var n=e.nodeType;if(n==3&&e.parentNode.tagName!="STYLE")r(e,e.nodeValue);if(n!=1)return;var o=e.getAttribute("each");if(o){i(e,t,o);return false}s(e.attributes,function(t){var n=t.name,i=t.value;var o=n.split("__")[1];r(e,i,{attr:o||n,bool:o});if(o){p(e,n);return false}});var u=b[e.tagName.toLowerCase()];if(u)u=new a(u,{root:e,parent:t})})}function a(n,r){var i=e.observable(this),a=[],f={},c=r.parent,v=r.loop,g=r.root,h=r.opts,b=r.item;if(!v&&g.riot)return;g.riot=1;h=h||{};d(this,{parent:c,root:g,opts:h});d(this,b);s(g.attributes,function(e){var t=e.name,n=e.value;f[t]=n;if(n.indexOf(y)>=0){p(g,t);return false}});function w(){Object.keys(f).map(function(e){h[e]=t(f[e],c||i)})}w();var x=m(n.tmpl),k;o(x,this);this.update=function(e,t){d(i,e);d(i,b);i.trigger("update");w();l(a,i,b);i.trigger("updated")};this.unmount=function(){var e=v?k:g,t=e.parentNode;if(t){t.removeChild(e);i.trigger("unmount");c&&c.off("update",i.update)}};function C(){if(v){k=x.firstChild;g.insertBefore(k,r.before||null)}else{while(x.firstChild)g.appendChild(x.firstChild)}if(g.stub)i.root=g=c.root;i.trigger("mount");c&&c.on("update",i.update).one("unmount",i.unmount)}if(n.fn)n.fn.call(this,h);u(x,this,a);this.update();C()}function f(e,t,n,r,i){n[e]=function(e){e=e||window.event;e.which=e.which||e.charCode||e.keyCode;e.target=e.target||e.srcElement;e.currentTarget=n;e.item=i;if(t.call(r,e)!==true){e.preventDefault&&e.preventDefault();e.returnValue=false}r.update()}}function c(e,t,n){if(e){e.insertBefore(n,t);e.removeChild(t)}}function l(e,n,r){s(e,function(e){var i=e.dom,o=e.attr,u=t(e.expr,n);if(u==null)u="";if(e.value===u)return;e.value=u;if(!o)return i.nodeValue=u;if(!u&&e.bool||/obj|func/.test(typeof u))p(i,o);if(typeof u=="function"){f(o,u,i,n,r)}else if(o=="if"){p(i,o);var a=e.stub;if(u){a&&c(a.parentNode,a,i)}else{a=e.stub=a||document.createTextNode("");c(i.parentNode,i,a)}}else if(/^(show|hide)$/.test(o)){p(i,o);if(o=="hide")u=!u;i.style.display=u?"":"none"}else if(o=="value"){i.value=u}else{if(e.bool){i[o]=u;if(!u)return;u=o}i.setAttribute(o,u)}})}function s(e,t){for(var n=0;n<(e||[]).length;n++){if(t(e[n],n)===false)n--}}function p(e,t){e.removeAttribute(t)}function d(e,t){t&&Object.keys(t).map(function(n){e[n]=t[n]});return e}function m(e){var t=e.trim().slice(1,3).toLowerCase(),n=/td|th/.test(t)?"tr":t=="tr"?"tbody":"div",r=document.createElement(n);r.stub=true;r.innerHTML=e;return r}function v(e,t){e=t(e)===false?e.nextSibling:e.firstChild;while(e){v(e,t);e=e.nextSibling}}function g(e,t){return e.filter(function(e){return t.indexOf(e)<0})}var h=[],b={},y;e.tag=function(t,n,r){y=y||(e.settings.brackets||"{ }").split(" ")[0];b[t]={name:t,tmpl:n,fn:r}};var w=e.mountTo=function(e,t,n){var r=b[t],i;if(r&&e){e.riot=0;i=new a(r,{root:e,opts:n})}if(i){h.push(i);return i.on("unmount",function(){h.splice(h.indexOf(i),1)})}};e.mount=function(e,t){if(e=="*")e=Object.keys(b).join(", ");var n=[];s(document.querySelectorAll(e),function(e){var r=e.tagName.toLowerCase(),i=w(e,r,t);if(i)n.push(i)});return n};e.update=function(){h.map(function(e){e.update()});return h};(function(t){var n=("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,"+"defaultchecked,defaultmuted,defaultselected,defer,disabled,draggable,enabled,formnovalidate,hidden,"+"indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,"+"pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,spellcheck,translate,truespeed,"+"typemustmatch,visible").split(",");var r="area,base,br,col,command,embed,hr,img,input,keygen,link,meta,param,source,track,wbr".split(",");var i={jade:b};var o={coffeescript:d,none:h,cs:d,es6:m,typescript:v,livescript:g,ls:g};var u=/^<([\w\-]+)>([^\x00]*[\w\-\/]>$)?([^\x00]*?)^<\/\1>/gim,a=/<script(\s+type=['"]?([^>'"]+)['"]?)?>([^\x00]*?)<\/script>/gm,f=/<!--.*?-->/g,c=/<([\w\-]+)([^>]*)\/\s*>/g,l=/^\s*\/\/.*$/gm,s=/\/\*[^\x00]*?\*\//gm;function p(e,t,i){e=e.replace(/\s+/g," ");e=e.trim().replace(f,"");e=e.replace(/=(\{[^\}]+\})([\s\/\>])/g,'="$1"$2');e=e.replace(/([\w\-]+)=["'](\{[^\}]+\})["']/g,function(e,t,r){if(n.indexOf(t.toLowerCase())>=0)t="__"+t;return t+'="'+r+'"'});if(t.expr){e=e.replace(/\{\s*([^\}]+)\s*\}/g,function(e,n){return"{"+w(n,t,i).trim().replace(/\r?\n|\r/g,"")+"}"})}e=e.replace(c,function(e,t,n){var i="<"+t+(n?" "+n.trim():"")+">";if(r.indexOf(t.toLowerCase())==-1)i+="</"+t+">";return i});e=e.replace(/'/g,"\\'");e=e.replace(/\\[{}]/g,"\\$&");if(t.compact)e=e.replace(/> </g,"><");return e}function d(e){return require("coffee-script").compile(e,{bare:true})}function m(e){return require("6to5").transform(e,{blacklist:["useStrict"]}).code}function v(e){return require("typescript-simple")(e)}function g(e){return require("LiveScript").compile(e,{bare:true,header:false})}function h(e){return e}function b(e){return require("jade").render(e,{pretty:true})}function y(e){e=e.replace(l,"").replace(s,"");var t=e.split("\n"),n="";t.forEach(function(e,r){var i=e.trim();if(i[0]!="}"&&i.indexOf("(")>0&&i.slice(-1)=="{"&&i.indexOf("function")==-1){var o=/(\s+)([\w]+)\s*\(([\w,\s]*)\)\s*\{/.exec(e);if(o&&!/^(if|while|switch|for)$/.test(o[2])){t[r]=o[1]+"this."+o[2]+" = function("+o[3]+") {";n=o[1]}}if(e.slice(0,n.length+1)==n+"}"){t[r]=n+n+"this.update()\n"+n+"}.bind(this);";n=""}});return t.join("\n")}function w(e,t,n){var r=t.parser||(n?o[n]:y);if(!r)throw new Error('Parser not found "'+n+'"');return r(e,t)}function x(e,t){var n=i[e];if(!n)throw new Error('Template parser not found "'+e+'"');return n(t)}function k(e,t){t=t||{};if(t.template)e=x(t.template,e);return e.replace(u,function(e,n,r,i){r=r||"";var o=t.type;if(!i.trim()){r=r.replace(a,function(e,t,n,r){if(n)o=n.replace("text/","");i=r;return""})}return"riot.tag('"+n+"', '"+p(r,t,o)+"', function(opts) {"+w(i,t,o)+"\n});"})}if(t){return module.exports={html:p,compile:k}}var C=document,j,O;function E(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState==4&&n.status==200)t(n.responseText)};n.open("GET",e,true);n.send("")}function T(e){var t=/[ \t]+/.exec(e);if(t)e=e.replace(new RegExp("^"+t[0],"gm"),"");return e}function L(e){var t=C.createElement("script"),n=C.documentElement;t.text=k(e);n.appendChild(t);n.removeChild(t)}function S(e){var t=C.querySelectorAll('script[type="riot/tag"]');[].map.call(t,function(n,r){var i=n.getAttribute("src");function o(n){L(n);if(r+1==t.length){j.trigger("ready");O=true;e&&e()}}return i?E(i,o):o(T(n.innerHTML))})}e.compile=function(t,n){if(typeof t=="string"){if(t.trim()[0]=="<"){var r=T(k(t));if(!n)L(r);return r}else{return E(t,function(e){var t=T(k(e));L(t);n&&n(t,e)})}}if(typeof t!="function")t=undefined;if(O)return t&&t();if(j){t&&j.on("ready",t)}else{j=e.observable();S(t)}};var N=e.mount,q=e.mountTo;e.mount=function(t,n){var r;e.compile(function(){r=N(t,n)});return r};e.mountTo=function(t,n,r){var i;e.compile(function(){i=q(t,n,r)});return i}})(!this.top);if(typeof exports==="object")module.exports=e;else if(typeof define==="function"&&define.amd)define(function(){return e});else this.riot=e})();
